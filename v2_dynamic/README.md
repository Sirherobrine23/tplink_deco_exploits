### Problem
- tplink firmware signature verfication prevents user-provided firmware installation
- previous exploit required reverse engineering the uboot code of each individual device version
- since symbol locations differed slightly between versions, someone still needed to solder a serial console each time

### Vulnerability
- in tplink webfailsafe modifications to uboot
- unconstrained sscanf reading "fw-type" from user-provided file into 256-byte stack buffer

### Exploit
- override return address on stack to gain control of PC
- point PC into uploaded firmware file to run arbitrary code
- have code search RAM for location of uboot builtin functions
- call uboot's built-in tftp functionality from the dynamically determined location

### Building
```
export STAGING_DIR=~/tplink/openwrt/staging_dir/
$STAGING_DIR/toolchain-mips_24kc_gcc-11.3.0_musl/bin/mips-openwrt-linux-musl-as -march mips32r2 shellcode.asm -o shellcode.o
$STAGING_DIR/toolchain-mips_24kc_gcc-11.3.0_musl/bin/mips-openwrt-linux-musl-ld -T shellcode.lk shellcode.o -o shellcode
$STAGING_DIR/toolchain-mips_24kc_gcc-11.3.0_musl/bin/mips-openwrt-linux-musl-objcopy -j ".text" -O binary shellcode shellcode.bin
python build_fw.py > deco_all_webfailsafe_faux_fw_tftp.bin
```
