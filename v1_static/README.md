### Problem
- tplink firmware signature verfication prevents user-provided firmware installation

### Vulnerability
- in tplink webfailsafe modifications to uboot
- unconstrained sscanf reading "fw-type" from user-provided file into 256-byte stack buffer

### Exploit
- override return address on stack to gain control of PC
- point PC into uploaded firmware file to run arbitrary code
- use code to hook back into uboot's built-in tftp functionality 

### Building
```
export STAGING_DIR=~/tplink/openwrt/staging_dir/
$STAGING_DIR/toolchain-mips_24kc_gcc-11.3.0_musl/bin/mips-openwrt-linux-musl-as shellcode.asm -o shellcode.o --defsym DECO_S4_V2=1
$STAGING_DIR/toolchain-mips_24kc_gcc-11.3.0_musl/bin/mips-openwrt-linux-musl-objcopy -j ".text" -O binary shellcode.o shellcode.bin
python build_fw.py > deco_s4_faux_fw_tftp.bin
```
